\chapter{Модель шумних даних в задачі семантичної сегментації}
Для систематизованого вивчення впливу рівня шуму в даних, та відповідного впливу запропонованих рішень, розроблено модель зашумлених даних задачі сегментації, що відповідає оцінкам моделей шуму в різних задачах автоматизованого скринінгу. 


\section{Аналіз зашумлення розмітки сегментації в задачі автоматизованого скринінгу}


Основними проблемами з розміткою даних в задачах скринінгу є:
\begin{itemize}
	\item Маски сегментації, що захоплюють сусідні з об'єктом пікселі \cite{severstal}
	\item Маски сегментації, що покривають об'єкт не повністю \cite{clouds}
	\item Відсутні маски сегментації для деяких об'єктів \cite{severstal}
	\item Присутні зайві маски на місцях, де немає об'єктів \cite{clouds}
\end{itemize}


\section{Моделювання зашумлення розмітки сегментації в задачі автоматизованого скринінгу}

Для моделювання цих дефектів розмітки запропоновано метод контрольованої генерації як зображень, так і масок сегментації що модифікуються відповідно до випадково обраних недоліків.

Контрольована генерація зображень виконується в два етапи: генерація фону та розташування на ньому довільної кількості об'єктів. Для генерації фону можуть бути використані як звичайні натуральні зображення, так і синтетичні текстури, чи заливка константним кольором. 

В якості об'єктів використовуються зображення з набору даних MNIST \cite{mnist}. Використання набору даних MNIST зумовлену трьом факторами: 
\begin{itemize}
	\item Можливість простого відділення об'єкта від фону;
	\item Наявність схожих елементів в різних класів (наприклад, цифри 1 та 7);
	\item Висока точність роботи сучасних нейронних мереж, що дозволяє сконцентруватися на впливі шуму в розмітці
\end{itemize}

Помилки в розмітку штучно вводяться за допомогою випадкового застосування морфологічних операцій ерозії та дилатації з квадратним ядром до масок сегментації окремих об'єктів перед додаванням їх до загальної маски. 

Окрім наборів даних зображень фону $\mathcal{X}_{b}$ та об'єктів $\mathcal{X}_{f}$, модель має наступні параметри:

\begin{itemize}
	\item Розмір зображення $S_{i}$ в пікселях
	\item Середній розмір об'єкта $S_{o}$ в пікселях
	\item Дисперсія розміру об'єкта $\sigma_{o}$
	\item Максимальна кількість об'єктів на зображенні $N$
	\item Ймовірності ерозії та дилатації маски кожного з об'єктів $P_e$ та $P_d$
	\item Розміри ядер ерозії та дилатації масок всіх об'єктів $S_e$ та $S_d$
\end{itemize}

На основі моделі генеруються навчальний та тестовий набори даних, всі зображення в наборах генеруються незалежно.

Алгоритм генерації кожного з зображень складається з наступних кроків:

1. Вибір випадкового зображення фону: $x_b \sim \mathcal{X}_b$

2. Вибір кількості об'єктів на зображенні: $n_o \sim \mathcal{U}(1, N)$

3. Ініціалізація маски сегментації: $M = 0_{S_i,S_i}$

4. Відповідно до кількості зображень $n_o$ виконати наступні кроки:

4.1 Вибрати зображення об'єкта $x_f \sim \mathcal{X}_f$

4.2 Вибрати розміри об'єкта: $s \sim \mathcal{U}(S_o - \sigma_o, S_o + \sigma_o)$

4.3 Змінити розмір зображення об'єкта за допомогою білінійної інтерполяції: 
\begin{align*}
	\hat{x}_f = R_{bilinear}(x_f)
\end{align*}

4.4 Вибрати координати розміщення об'єкта: 
\begin{align*}
	i_f &\sim \mathcal{U}(0, S_i - s)\\
	j_f &\sim \mathcal{U}(0, S_i - s)
\end{align*}


4.5 Розмістити зображення об'єкта на зображенні фону:
\begin{equation*}
x_b[i_f...i_f+s, j_f...j_f+s] = max(x_b[i_f...i_f+s, j_f...j_f+s], x_f)
\end{equation*}


